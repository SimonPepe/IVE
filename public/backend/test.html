<!DOCTYPE html>
<html>
	<head>
		<title>My first three.js app</title>
		<style>
			body {
				margin: 0;
			}

			canvas {}

			#video-container {
				z-index: 0;
				background-color: rgba(0, 0, 255, 1);
				text-align: center;
				position: absolute;
				width: 100%;
			}

			#overlay-container {
				z-index: 1;
				position: absolute;
			}
		</style>
	</head>
	<body>

		<div id="video-container">
			<video id="video" width="100%" loop muted autoplay preload="none">
			  	<source src="../videos/geo-1/geo1-main-entrance.mp4" type="video/mp4" />
				<source src="../videos/geo-1/geo1-main-entrance.ogv" type="video/ogg; codecs=theora, vorbis" />
			</video>
		</div>

		<div id="overlay-container"></div>

		<script src="../bower_components/jquery/dist/jquery.min.js"></script>
		<script src="../bower_components/three.js/build/three.min.js"></script>
		<script>
		// Start new scence
		var scene = new THREE.Scene();

		// Load div-overlay-container sizes
		var video_container = $( '#video-container' );
		var overlay_container = $( '#overlay-container' );
        var vid = document.getElementById("video");

		//Wait for the video to load 
        vid.onloadeddata = function () {
            console.log("videoheight  " + $( '#video' ).height());
            console.log("videowidth  " + $( '#video' ).width());
            console.log("video-containerheight  " + $( '#video-container' ).height());
            console.log("video-containerwidth  " + $( '#video-container' ).width());

            var overlay_container_width = $( '#video-container' ).width();
            var overlay_container_height = $( '#video-container' ).height();

            console.log("overlayheight  " + overlay_container_height);
            console.log("overlaywidth  " + overlay_container_width);

            // Resize container
            overlay_container.css( "width", overlay_container_width);
            overlay_container.css( "height", overlay_container_height);

            // Set new position to overlay containers over each other
            //overlay_container.position( "top", video_container.position.top * -1);

            // Set camera position
            var camera = new THREE.PerspectiveCamera( 75, overlay_container.width() / overlay_container.height(), 0.1, 1000 );

			/*var camera = new THREE.PerspectiveCamera( 50, overlay_container.width() / overlay_container.height(), 1, 3000 );
			 camera.position.set( 0, 101, 300 );
			 camera.lookAt(new THREE.Vector3( 0, 101, 0 ));*/

            // Create renderer and allow transparent backgroun-color
            var renderer = new THREE.WebGLRenderer({
                alpha: true
            });
            // Set size with width and height of the div-overlay-container
            renderer.setSize(overlay_container.width(), overlay_container.height());
            // Set background color to transparent
            renderer.setClearColor(0xffffff, 0);
            // Add canvas to overlay_container
            overlay_container.append(renderer.domElement);



            var geometry = new THREE.BoxGeometry( 1, 1, 1 );
            var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
            var cube = new THREE.Mesh( geometry, material );
            scene.add( cube );

            camera.position.z = 5;

            var render = function () {
                requestAnimationFrame( render );

                cube.rotation.x += 0.1;
                cube.rotation.y += 0.1;

                renderer.render(scene, camera);
            };

            render();

            window.addEventListener( 'resize', onWindowResize, false );

            function onWindowResize(){

                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();

                renderer.setSize( window.innerWidth, window.innerHeight );
            }
        }

		</script>
	</body>
</html>
